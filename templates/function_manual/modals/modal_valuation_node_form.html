<!-- templates/function_manual/modals/modal_valuation_node_form.html -->
<div class="modal" :class="{ 'is-active': showModal }" v-if="showModal">
    <div class="modal-overlay" @click="closeModal"></div>
    <div class="modal-container">
        <div class="modal-header">
            <h3>[[ isEdit ? 'Editar ' : 'Nuevo ' ]] [[ currentNodeTypeName ]]</h3>
            <button class="btn-close-modal" @click="closeModal">&times;</button>
        </div>

        <form @submit.prevent="saveNode">
            <div class="modal-body">
                <!-- Select de Catálogos -->
                <div class="form-group"
                     v-if="['ROLE', 'INSTRUCTION', 'DECISION', 'IMPACT', 'COMPLEXITY'].includes(workingType)">
                    <label class="form-label">Seleccionar Item de Catálogo</label>
                    <select v-model="formData.catalog_item_id" class="form-control" required>
                        <option value="">Seleccione una opción...</option>
                        <option v-for="item in filteredCatalogItems" :key="item.id" :value="item.id">
                            [[ item.name ]]
                        </option>
                    </select>
                </div>

                <!-- Input de Texto (Experiencia) -->
                <div class="form-group" v-if="workingType === 'EXPERIENCE'">
                    <label class="form-label">Descripción de Experiencia</label>
                    <input type="text" v-model="formData.name_extra" class="form-control"
                           placeholder="Ej: Mínimo 24 meses" required>
                </div>

                <!-- Select de Matriz (Resultado) -->
                <div class="form-group" v-if="workingType === 'RESULT'">
                    <label class="form-label">Vincular Clasificación Ocupacional</label>
                    <select v-model="formData.occupational_classification_id" class="form-control" required>
                        <option value="">Seleccione clasificación...</option>
                        <option v-for="m in catalogs.matrix" :key="m.id" :value="m.id">
                            [[ m.occupational_group ]] ($[[ m.remuneration ]])
                        </option>
                    </select>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-cancel" @click="closeModal">Cancelar</button>
                <button type="submit" class="btn btn-save" :disabled="loading">
                    <i v-if="loading" class="fa-solid fa-spinner fa-spin"></i>
                    [[ loading ? 'Guardando...' : 'Guardar Registro' ]]
                </button>
            </div>
        </form>
    </div>
</div>