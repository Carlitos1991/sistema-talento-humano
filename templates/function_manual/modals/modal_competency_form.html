<!-- templates/function_manual/modals/modal_competency_form.html -->
<div class="modal" :class="{ 'is-active': showModal }" v-if="showModal">
    <!-- El overlay para cerrar al hacer click fuera -->
    <div class="modal-overlay" @click="closeModal"></div>

    <div class="modal-container">
        <div class="modal-header">
            <h3>[[ isEdit ? 'Editar Competencia' : 'Nueva Competencia' ]]</h3>
            <button class="btn-close-modal" @click="closeModal">&times;</button>
        </div>

        <form @submit.prevent="saveCompetency">
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Nombre de la Competencia</label>
                    <input type="text" v-model="formData.name" required class="form-control"
                           placeholder="Ej: Liderazgo Estratégico">
                </div>

                <div class="grid-2-cols mt-3">
                    <div class="form-group">
                        <label class="form-label">Tipo</label>
                        <select v-model="formData.type" class="form-control">
                            <option value="TECHNICAL">Técnica</option>
                            <option value="BEHAVIORAL">Conductual</option>
                            <option value="TRANSVERSAL">Transversal</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nivel Sugerido</label>
                        <select v-model="formData.suggested_level" class="form-control">
                            <option value="">Seleccione nivel...</option>
                            <option v-for="lvl in complexityLevels" :key="lvl.id" :value="lvl.id">
                                [[ lvl.name ]]
                            </option>
                        </select>
                    </div>
                </div>

                <div class="form-group mt-3">
                    <label class="form-label">Definición / Descripción</label>
                    <textarea v-model="formData.definition" rows="4" class="form-control"
                              placeholder="Describa la competencia..."></textarea>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-cancel" @click="closeModal">Cancelar</button>
                <button type="submit" class="btn btn-save" :disabled="loading">
                    <span v-if="loading"><i class="fa-solid fa-spinner fa-spin"></i> Guardando...</span>
                    <span v-else>Guardar Cambios</span>
                </button>
            </div>
        </form>
    </div>
</div>