<!DOCTYPE html>
<html>
<head>
    <style>
        @page {
            size: A4 landscape;
            margin: 1cm;
        }
        body { font-family: Helvetica, Arial, sans-serif; font-size: 9px; color: #333; }
        .header { text-align: center; margin-bottom: 20px; }
        .info-table { width: 100%; margin-bottom: 10px; border-bottom: 2px solid #000; }

        /* Estilo Calendario */
        table.calendar { width: 100%; border-collapse: collapse; table-layout: fixed; }
        table.calendar th {
            background-color: #f2f2f2;
            border: 1px solid #000;
            padding: 5px;
            text-align: center;
            font-weight: bold;
        }
        table.calendar td {
            border: 1px solid #000;
            height: 100px; /* Altura de la celda del día */
            vertical-align: top;
            padding: 0;
        }
        .day-header {
            background-color: #fafafa;
            border-bottom: 1px solid #ddd;
            padding: 2px 4px;
            font-weight: bold;
            text-align: right;
        }
        .punch-row {
            padding: 1px 3px;
            border-bottom: 0.5px solid #eee;
            font-size: 8px;
        }
        .punch-time { font-weight: bold; color: #000; }
        .punch-device { color: #666; font-size: 7px; }
    </style>
</head>
<body>
    <div class="header">
        <h2>REPORTE MENSUAL DE ASISTENCIA</h2>
        <h3>{{ month_name }} {{ year }}</h3>
    </div>

    <table class="info-table">
        <tr>
            <td><strong>EMPLEADO:</strong> {{ emp.person.full_name }}</td>
            <td><strong>CÉDULA:</strong> {{ emp.person.document_number }}</td>
            <td align="right"><strong>FECHA IMPRESIÓN:</strong> {{ today|date:"d/m/Y" }}</td>
        </tr>
    </table>

    <table class="calendar">
        <thead>
            <tr>
                <th>Lunes</th><th>Martes</th><th>Miércoles</th><th>Jueves</th><th>Viernes</th><th>Sábado</th><th>Domingo</th>
            </tr>
        </thead>
        <tbody>
            {% for week in calendar %}
            <tr>
                {% for day_obj in week %}
                <td>
                    {% if day_obj.day %}
                        <div class="day-header">{{ day_obj.day }}</div>
                        {% for p in day_obj.punches %}
                            <div class="punch-row">
                                <span class="punch-time">{{ p.time }}</span>
                                <span class="punch-device">{{ p.device }}</span>
                            </div>
                        {% endfor %}
                    {% endif %}
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>