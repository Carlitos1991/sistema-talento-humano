<div v-if="showModal" class="modal-overlay" @click.self="closeModal">
    <div class="modal-container-medium">
        <div class="modal-header-gradient">
            <div class="header-content-group">
                <div class="header-icon-circle"><i class="fa-solid fa-fingerprint"></i></div>
                <h3 class="header-title-main">[[ modalTitle ]]</h3>
            </div>
            <button @click="closeModal" class="btn-close-modal-refined">&times;</button>
        </div>

        <form @submit.prevent="saveDevice">
            <div class="modal-body-custom">
                <div class="form-section-card">
                    <div class="section-title"><i class="fa-solid fa-info-circle"></i> Datos Técnicos</div>
                    <div class="form-group mb-3">
                        <label class="form-label">Nombre del Dispositivo(*)</label>
                        <input type="text" v-model="form.name" class="form-control" placeholder="Ej. Hall" required>
                    </div>
                    <div class="grid-2-cols">
                        <div class="form-group">
                            <label class="form-label">Dirección IP(*)</label>
                            <input type="text" v-model="form.ip_address" class="form-control"
                                   placeholder="Ej. 192.168.1.100" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Puerto</label>
                            <input type="number" v-model="form.port" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-group mt-3">
                        <label class="form-label">Ubicación Física</label>
                        <input type="text" v-model="form.location" placeholder="Ej. Primer piso" class="form-control">
                    </div>
                    <div class="form-group mt-4 d-flex align-items-center justify-content-between"
                         style="background: #f8fafc; padding: 12px 15px; border-radius: 10px; border: 1px solid #e2e8f0;">
                        <div>
                            <label class="form-label mb-0" style="font-weight: 700;">Estado del Dispositivo</label>
                            <p class="mb-0" style="font-size: 0.75rem; color: #64748b;">Habilitar o deshabilitar
                                conexión</p>
                        </div>
                        <div class="d-flex align-items-center gap-3">
                            <span :class="form.is_active ? 'text-success' : 'text-danger'"
                                  style="font-size: 0.8rem; font-weight: 800; text-transform: uppercase;">
                                [[ form.is_active ? 'Activo' : 'Inactivo' ]]
                            </span>
                            <label class="toggle-switch">
                                <input type="checkbox" v-model="form.is_active">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer-fixed">
                <button type="button" @click="closeModal" class="btn-cancel">Cancelar</button>
                <button type="submit" class="btn-save" :disabled="isSaving">
                    <i v-if="isSaving" class="fas fa-spinner fa-spin"></i>
                    [[ isSaving ? 'Guardando...' : 'Guardar Dispositivo' ]]
                </button>
            </div>
        </form>
    </div>
</div>